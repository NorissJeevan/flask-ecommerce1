{% extends 'layout.html' %}

{% block title %}Tradello - Products{% endblock %}

{% block css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/style2.css') }}">
{% endblock %}

{% block header_content %}{% endblock %}

{% block content %}
<!-- ADD TOP ALERT HERE -->
<div class="alert alert-info w-100 alert-dismissible fade show" role="alert">
  <p>Not looking for unicorn plus toys? browse our other unicorn products</p>
  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>

<!-- Main Content -->
<main class="container">
  <div class="row">
    <!-- Carousel Images -->
    <div class="col-md-7">
      <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
        <div class="carousel-inner">
          <div class="carousel-item active">
            <img class="d-block w-100" src="{{ url_for('static', filename='images/product1.png') }}" alt="First slide">
          </div>
          <div class="carousel-item">
            <img class="d-block w-100" src="{{ url_for('static', filename='images/product2.png') }}" alt="Second slide">
          </div>
          <div class="carousel-item">
            <img class="d-block w-100" src="{{ url_for('static', filename='images/product3.png') }}" alt="Third slide">
          </div>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>
    </div>

    <!-- Main Product Information -->
    <div class="col-md-5">
      <h2>Giant Unicorn Plush
        <span class="badge badge-secondary">New</span>
      </h2>
      <p>Soft, Sparkly, Magical</p>
      <hr>
      <h6>Price</h6>
      <p>$99.99</p>

      <!-- Form for adding to cart -->
      <form id="quantityOfUnicornsForm" action="{{ url_for('add_to_cart') }}" method="post">
        <input type="hidden" name="product_id" value="14">
        <div class="form-row add-to-cart align-items-center">
          <div class="col-12 my-1">
            <label class="mr-sm-12" for="quantityOfUnicorns">Select a Quantity</label>
          </div>
          <div class="col-12 my-1 form-group">
            <select class="custom-select mr-sm-2 form-control" id="quantityOfUnicorns" name="quantity">
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
            </select>
          </div>
          <div class="col-12 my-1">
            <button type="submit" class="btn btn-primary">Add to Cart</button>
          </div>
        </div>
      </form>
    </div>
  </div>

  <!-- Scrollspy connected to Dropdown Menu -->
  <div data-spy="scroll" data-target="#sections" data-offset="0">
    <!-- Product Information -->
    <div class="row">
      <div class="col-12">
        <h4 id="product-info" class="section-header">Product Information</h4>

        <!-- Product Information Tabs -->
        <nav>
          <div class="nav nav-tabs" id="nav-tab" role="tablist">
            <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true">Description</a>
            <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false">Details</a>
          </div>
        </nav>
        <div class="tab-content" id="nav-tabContent">
          <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
            <p>This graceful unicorn will prance right into any child's collection -- and heart! With its pretty 
              pink mane and tail, both scattered through with shimmering silver strands that catch the light, 
              this enchanting friend is sure to become a new favorite. Additional irresistible details include 
              super-silky plush fur, satin star decorations, beautiful blue eyes, and a soft, shiny horn.</p>
          </div>
          <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
            <ul>
              <li>Suitable for ages 3 years and up</li>
              <li>Silky plush fur</li>
              <li>Measure 36" H</li>
              <li>Imported</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Similar Items -->
    <div class="row">
      <div class="col-12">
        <h4 id="similar-items" class="section-header">Similar Items</h4>
        <div class="row">
          <div class="col-3">
            <img class="w-100" src="{{ url_for('static', filename='images/recommendedProduct1.jpg') }}" alt="First similar">
          </div>
          <div class="col-3">
            <img class="w-100" src="{{ url_for('static', filename='images/recommendedProduct2.jpg') }}" alt="Second similar">
          </div>
          <div class="col-3">
            <img class="w-100" src="{{ url_for('static', filename='images/recommendedProduct3.jpg') }}" alt="Third similar">
          </div>
          <div class="col-3">
            <img class="w-100" src="{{ url_for('static', filename='images/recommendedProduct4.jpg') }}" alt="Fourth similar">
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- Chat Button with Popover-->
<button id="chatPopover" type="button" class="chat btn">Need help?</button>

<!-- Modal -->
<div class="modal fade" id="signUpModal" tabindex="-1" role="dialog" aria-labelledby="mySignUpModal" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <!-- Modal Header -->
      <div class="modal-header">
        <h5 class="modal-title" id="modalHeader">Sign up for savings sent right to your inbox!</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <!-- Modal Body - Form -->
      <div class="modal-body">
        <form>
          <div class="form-group">
            <label for="formGroupFirstNameInput">First Name</label>
            <input type="text" class="form-control" id="formGroupFirstNameInput" placeholder="">
          </div>
          <div class="form-group">
            <label for="formGroupLastNameInput2">Last Name</label>
            <input type="text" class="form-control" id="formGroupLastNameInput2" placeholder="">
          </div>
          <div class="form-group">
            <label for="formGroupInputEmail">E-mail</label>
            <input type="email" class="form-control" id="formGroupInputEmail" aria-describedby="emailHelp" placeholder="Enter email">
            <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
          </div>
          <div class="form-check">
            <input type="checkbox" class="form-check-input" id="exampleCheck1">
            <label class="form-check-label" for="exampleCheck1">Check me out</label>
          </div>
        </form>
      </div>

      <!-- Modal Footer - Button -->
      <div class="modal-footer">
        <button type="button" id="signUpBtn" class="btn btn btn-primary">Sign me up!</button>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/app2.js') }}"></script>
<script>
  // Handle add to cart form
  $(document).ready(function() {
    $('#quantityOfUnicornsForm').submit(function(e) {
      e.preventDefault();
      
      $.ajax({
        type: 'POST',
        url: $(this).attr('action'),
        data: $(this).serialize(),
        dataType: 'json',
        success: function(response) {
          alert(response.message);
          $('#cartItems').text(response.cart_count);
        },
        error: function(xhr) {
          if (xhr.status === 401) {
            // Not logged in
            window.location.href = "{{ url_for('register') }}";
          } else {
            alert('Error: ' + xhr.responseJSON.message);
          }
        }
      });
    });

    // Setup the sign up button
    $('.signUpButton').click(function() {
      $('#signUpModal').modal('show');
    });
  });
</script>
{% endblock %}
